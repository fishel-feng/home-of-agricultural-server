{"version":3,"sources":["../../../app/controller/circle.js"],"names":["Controller","require","module","exports","ctx","validate","content","images","request","body","service","circle","addCircle","circleId","deleteCircle","status","targetId","type","required","allowEmpty","addComment","comment","commentId","deleteComment","giveLike","cancelLike","last","params","getAttentionList","result","circleList","getCircleList","getComment","getLikeList"],"mappings":"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","file":"circle.js","sourcesContent":["'use strict';\n\nconst Controller = require('egg').Controller;\n\nmodule.exports = class CircleController extends Controller {\n\n  /**\n   * 发表动态\n   */\n  async addCircle() {\n    this.ctx.validate({\n      content: 'string',\n      images: 'array',\n    });\n    const {\n      content,\n      images,\n    } = this.ctx.request.body;\n    const circle = await this.service.circle.addCircle(content, images);\n    this.ctx.body = circle;\n  }\n\n  /**\n   * 删除动态\n   */\n  async deleteCircle() {\n    this.ctx.validate({\n      circleId: 'string',\n    });\n    const {\n      circleId,\n    } = this.ctx.request.body;\n    const status = await this.service.circle.deleteCircle(circleId);\n    this.ctx.body = status;\n  }\n\n  /**\n   * 添加评论\n   */\n  async addComment() {\n    this.ctx.validate({\n      circleId: 'string',\n      content: 'string',\n      targetId: {\n        type: 'string',\n        required: false,\n        allowEmpty: true,\n      },\n    });\n    const {\n      circleId,\n      content,\n      targetId,\n    } = this.ctx.request.body;\n    const comment = await this.service.circle.addComment(circleId, content, targetId);\n    this.ctx.body = comment;\n  }\n\n  /**\n   * 删除评论\n   */\n  async deleteComment() {\n    this.ctx.validate({\n      circleId: 'string',\n      commentId: 'integer',\n    });\n    const {\n      circleId,\n      commentId,\n    } = this.ctx.request.body;\n    const status = await this.service.circle.deleteComment(circleId, commentId);\n    this.ctx.body = {\n      status,\n    };\n  }\n\n  /**\n   * 点赞\n   */\n  async giveLike() {\n    this.ctx.validate({\n      circleId: 'string',\n    });\n    const {\n      circleId,\n    } = this.ctx.request.body;\n    const status = await this.service.circle.giveLike(circleId);\n    this.ctx.body = status;\n  }\n\n  /**\n   * 取消赞\n   */\n  async cancelLike() {\n    this.ctx.validate({\n      circleId: 'string',\n    });\n    const {\n      circleId,\n    } = this.ctx.request.body;\n    const status = await this.service.circle.cancelLike(circleId);\n    this.ctx.body = status;\n  }\n\n  /**\n   * 查看关注的人动态\n   */\n  async getAttentionList() {\n    const last = this.ctx.params.last;\n    const result = await this.service.circle.getAttentionList(last);\n    this.ctx.body = {\n      circleList: result,\n    };\n  }\n\n  /**\n   * 查看动态\n   */\n  async getCircleList() {\n    const last = this.ctx.params.last;\n    const result = await this.service.circle.getCircleList(last);\n    this.ctx.body = {\n      circleList: result,\n    };\n  }\n\n  /**\n   * 查看评论\n   */\n  async getComment() {\n    const circleId = this.ctx.params.circleId;\n    const result = await this.service.circle.getComment(circleId);\n    this.ctx.body = result;\n  }\n\n  /**\n   * 查看点赞列表\n   */\n  async getLikeList() {\n    const circleId = this.ctx.params.circleId;\n    const result = await this.service.circle.getLikeList(circleId);\n    this.ctx.body = result;\n  }\n};\n"]}