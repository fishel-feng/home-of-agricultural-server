{"version":3,"sources":["../../../app/controller/circle.js"],"names":["Controller","require","CircleController","ctx","validate","content","images","request","body","service","circle","addCircle","circleId","deleteCircle","status","targetId","type","required","addComment","comment","commentId","deleteComment","giveLike","cancelLike","last","params","getAttentionList","result","circleList","getCircleList","getComment","getLikeList","module","exports"],"mappings":"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","file":"circle.js","sourcesContent":["'use strict';\n\nconst Controller = require('egg').Controller;\n\nclass CircleController extends Controller {\n\n  /**\n   * 发表动态\n   */\n  async addCircle() {\n    this.ctx.validate({\n      content: 'string',\n      images: 'array',\n    });\n    const {\n      content,\n      images,\n    } = this.ctx.request.body;\n    const circle = await this.service.circle.addCircle(content, images);\n    this.ctx.body = circle;\n  }\n\n  /**\n   * 删除动态\n   */\n  async deleteCircle() {\n    this.ctx.validate({\n      circleId: 'string',\n    });\n    const {\n      circleId,\n    } = this.ctx.request.body;\n    // TODO 删除图片\n    const status = await this.service.circle.deleteCircle(circleId);\n    this.ctx.body = status;\n  }\n\n  /**\n   * 添加评论\n   */\n  async addComment() {\n    this.ctx.validate({\n      circleId: 'string',\n      content: 'string',\n      targetId: {\n        type: 'string',\n        required: false,\n      },\n    });\n    const {\n      circleId,\n      content,\n      targetId,\n    } = this.ctx.request.body;\n    const comment = await this.service.circle.addComment(circleId, content, targetId);\n    this.ctx.body = comment;\n  }\n\n  /**\n   * 删除评论\n   */\n  async deleteComment() {\n    this.ctx.validate({\n      circleId: 'string',\n      commentId: 'integer',\n    });\n    const {\n      circleId,\n      commentId,\n    } = this.ctx.request.body;\n    const status = await this.service.circle.deleteComment(circleId, commentId);\n    this.ctx.body = {\n      status,\n    };\n  }\n\n  /**\n   * 点赞\n   */\n  async giveLike() {\n    this.ctx.validate({\n      circleId: 'string',\n    });\n    const {\n      circleId,\n    } = this.ctx.request.body;\n    const status = await this.service.circle.giveLike(circleId);\n    this.ctx.body = status;\n  }\n\n  /**\n   * 取消赞\n   */\n  async cancelLike() {\n    this.ctx.validate({\n      circleId: 'string',\n    });\n    const {\n      circleId,\n    } = this.ctx.request.body;\n    const status = await this.service.circle.cancelLike(circleId);\n    this.ctx.body = status;\n  }\n\n  /**\n   * 查看关注的人动态\n   */\n  async getAttentionList() {\n    const last = this.ctx.params.last;\n    const result = await this.service.circle.getAttentionList(last);\n    this.ctx.body = {\n      circleList: result,\n    };\n  }\n\n  /**\n   * 查看动态\n   */\n  async getCircleList() {\n    const last = this.ctx.params.last;\n    const result = await this.service.circle.getCircleList(last);\n    this.ctx.body = {\n      circleList: result,\n    };\n  }\n\n  /**\n   * 查看评论\n   */\n  async getComment() {\n    const circleId = this.ctx.params.circleId;\n    const result = await this.service.circle.getComment(circleId);\n    this.ctx.body = result;\n  }\n\n  /**\n   * 查看点赞列表\n   */\n  async getLikeList() {\n    const circleId = this.ctx.params.circleId;\n    const result = await this.service.circle.getLikeList(circleId);\n    this.ctx.body = result;\n  }\n}\n\nmodule.exports = CircleController;\n"]}