{"version":3,"sources":["../../../app/controller/circle.js"],"names":["Controller","require","CircleController","ctx","validate","content","images","request","body","service","circle","addCircle","circleId","deleteCircle","status","targetId","type","required","allowEmpty","addComment","comment","commentId","deleteComment","giveLike","cancelLike","last","params","getAttentionList","result","circleList","getCircleList","getComment","getLikeList","module","exports"],"mappings":"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","file":"circle.js","sourcesContent":["'use strict';\n\nconst Controller = require('egg').Controller;\n\nclass CircleController extends Controller {\n\n  /**\n   * 发表动态\n   */\n  async addCircle() {\n    this.ctx.validate({\n      content: 'string',\n      images: 'array',\n    });\n    const {\n      content,\n      images,\n    } = this.ctx.request.body;\n    const circle = await this.service.circle.addCircle(content, images);\n    this.ctx.body = circle;\n  }\n\n  /**\n   * 删除动态\n   */\n  async deleteCircle() {\n    this.ctx.validate({\n      circleId: 'string',\n    });\n    const {\n      circleId,\n    } = this.ctx.request.body;\n    const status = await this.service.circle.deleteCircle(circleId);\n    this.ctx.body = status;\n  }\n\n  /**\n   * 添加评论\n   */\n  async addComment() {\n    this.ctx.validate({\n      circleId: 'string',\n      content: 'string',\n      targetId: {\n        type: 'string',\n        required: false,\n        allowEmpty: true,\n      },\n    });\n    const {\n      circleId,\n      content,\n      targetId,\n    } = this.ctx.request.body;\n    const comment = await this.service.circle.addComment(circleId, content, targetId);\n    this.ctx.body = comment;\n  }\n\n  /**\n   * 删除评论\n   */\n  async deleteComment() {\n    this.ctx.validate({\n      circleId: 'string',\n      commentId: 'integer',\n    });\n    const {\n      circleId,\n      commentId,\n    } = this.ctx.request.body;\n    const status = await this.service.circle.deleteComment(circleId, commentId);\n    this.ctx.body = {\n      status,\n    };\n  }\n\n  /**\n   * 点赞\n   */\n  async giveLike() {\n    this.ctx.validate({\n      circleId: 'string',\n    });\n    const {\n      circleId,\n    } = this.ctx.request.body;\n    const status = await this.service.circle.giveLike(circleId);\n    this.ctx.body = status;\n  }\n\n  /**\n   * 取消赞\n   */\n  async cancelLike() {\n    this.ctx.validate({\n      circleId: 'string',\n    });\n    const {\n      circleId,\n    } = this.ctx.request.body;\n    const status = await this.service.circle.cancelLike(circleId);\n    this.ctx.body = status;\n  }\n\n  /**\n   * 查看关注的人动态\n   */\n  async getAttentionList() {\n    const last = this.ctx.params.last;\n    const result = await this.service.circle.getAttentionList(last);\n    this.ctx.body = {\n      circleList: result,\n    };\n  }\n\n  /**\n   * 查看动态\n   */\n  async getCircleList() {\n    const last = this.ctx.params.last;\n    const result = await this.service.circle.getCircleList(last);\n    this.ctx.body = {\n      circleList: result,\n    };\n  }\n\n  /**\n   * 查看评论\n   */\n  async getComment() {\n    const circleId = this.ctx.params.circleId;\n    const result = await this.service.circle.getComment(circleId);\n    this.ctx.body = result;\n  }\n\n  /**\n   * 查看点赞列表\n   */\n  async getLikeList() {\n    const circleId = this.ctx.params.circleId;\n    const result = await this.service.circle.getLikeList(circleId);\n    this.ctx.body = result;\n  }\n}\n\nmodule.exports = CircleController;\n"]}