{"version":3,"sources":["../../../app/controller/question.js"],"names":["Controller","require","QuestionController","ctx","validate","title","content","tag","images","request","body","service","question","addQuestion","questionId","deleteQuestion","status","addAnswer","answer","answerId","deleteAnswer","params","getExpertList","experts","last","getQuestionList","questions","getAllQuestionList","id","getQuestion","result","getTags","tags","module","exports"],"mappings":"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","file":"question.js","sourcesContent":["'use strict';\nconst Controller = require('egg').Controller;\nclass QuestionController extends Controller {\n\n  /**\n   * 新建问题\n   */\n  async addQuestion() {\n    this.ctx.validate({\n      title: 'string',\n      content: 'string',\n      tag: 'string',\n      images: 'array',\n    });\n    const {\n      title,\n      content,\n      tag,\n      images,\n    } = this.ctx.request.body;\n    const question = await this.service.question.addQuestion(title, content, tag, images);\n    this.ctx.body = question;\n  }\n\n  /**\n   * 删除问题\n   */\n  async deleteQuestion() {\n    this.ctx.validate({\n      questionId: 'string',\n    });\n    const {\n      questionId,\n    } = this.ctx.request.body;\n    // TODO 删除图片\n    const status = await this.service.question.deleteQuestion(questionId);\n    this.ctx.body = status;\n  }\n\n  /**\n   * 添加回答\n   */\n  async addAnswer() {\n    this.ctx.validate({\n      questionId: 'string',\n      content: 'string',\n      images: 'array',\n    });\n    const {\n      questionId,\n      content,\n      images,\n    } = this.ctx.request.body;\n    const answer = await this.service.question.addAnswer(questionId, content, images);\n    this.ctx.body = answer;\n  }\n\n  /**\n   * 删除回答\n   */\n  async deleteAnswer() {\n    this.ctx.validate({\n      questionId: 'string',\n      answerId: 'integer',\n    });\n    const {\n      questionId,\n      answerId,\n    } = this.ctx.request.body;\n    const status = await this.service.question.deleteAnswer(questionId, answerId);\n    this.ctx.body = {\n      status,\n    };\n  }\n\n  /**\n   * 关注问题\n   */\n  async attentionQuestion() {\n    this.ctx.validate({\n      questionId: 'string',\n    });\n    const {\n      questionId,\n    } = this.ctx.request.body;\n    const status = await this.service.question.deleteAnswer(questionId);\n    this.ctx.body = {\n      status,\n    };\n  }\n\n  /**\n   * 获取专家列表\n   */\n  async getExpertList() {\n    const tag = this.ctx.params.tag;\n    const experts = await this.service.question.getExpertList(tag);\n    this.ctx.body = {\n      experts,\n    };\n  }\n\n  /**\n   * 分类获取问题列表\n   */\n  async getQuestionList() {\n    const tag = this.ctx.params.tag;\n    const last = this.ctx.params.last;\n    const questions = await this.service.question.getQuestionList(tag, last);\n    this.ctx.body = {\n      questions,\n    };\n  }\n\n  /**\n   * 获取全部问题列表\n   */\n  async getAllQuestionList() {\n    const last = this.ctx.params.last;\n    const questions = await this.service.question.getAllQuestionList(last);\n    this.ctx.body = {\n      questions,\n    };\n  }\n\n  /**\n   * 查看问题详情\n   */\n  async getQuestion() {\n    const id = this.ctx.params.questionId;\n    const result = await this.service.question.getQuestion(id);\n    this.ctx.body = result;\n  }\n\n  /**\n   * 获取问题标签\n   */\n  async getTags() {\n    const tags = await this.service.question.getTags();\n    this.ctx.body = tags;\n  }\n}\n\nmodule.exports = QuestionController;\n"]}